<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>HospitalOS â€” Management Dashboard (Demo)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Beautiful font pairing */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Plus+Jakarta+Sans:wght@400;700&display=swap');
    :root{
      --bg1:#0b1220;
      --bg2:#0e1630;
      --card:#0f1b3d99;
      --accent:#6ee7ff;
      --accent2:#a78bfa;
      --glass: rgba(255,255,255,0.08);
      --stroke: rgba(255,255,255,0.12);
      --glow: #74f1ff;
    }
    html,body{ height:100%; }
    body{
      background: radial-gradient(1000px 700px at 10% 10%, #14224f 0%, transparent 60%),
                  radial-gradient(900px 600px at 90% 20%, #2a0b52 0%, transparent 60%),
                  linear-gradient(180deg, var(--bg1), var(--bg2));
      color:#eaf2ff;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      overflow-x:hidden;
    }

    /* Floating glow orbs for ambiance */
    .orb{
      position:absolute; border-radius:9999px; filter: blur(40px);
      opacity:.35; animation: float 14s ease-in-out infinite;
    }
    .orb.one{ width:340px; height:340px; left:-120px; top:-60px; background:#6ee7ff55; }
    .orb.two{ width:420px; height:420px; right:-160px; top:120px; background:#a78bfa55; animation-duration:18s;}
    .orb.three{ width:360px; height:360px; left:40%; bottom:-160px; background:#22d3ee44; animation-duration:22s;}
    @keyframes float{
      0%{ transform: translateY(0) rotate(0deg); }
      50%{ transform: translateY(-18px) rotate(3deg); }
      100%{ transform: translateY(0) rotate(0deg); }
    }

    /* Glass card */
    .glass{
      background: linear-gradient(180deg, rgba(255,255,255,0.09), rgba(255,255,255,0.04));
      border:1px solid var(--stroke);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
    }

    /* Liquid Glass Button */
    .liquid-btn{
      position: relative;
      isolation:isolate;
      border: 1px solid rgba(255,255,255,0.18);
      background: linear-gradient(180deg, rgba(255,255,255,0.16), rgba(255,255,255,0.06));
      color:#eaf6ff;
      overflow:hidden;
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.25), 0 8px 30px rgba(0,0,0,.25);
    }
    .liquid-btn:hover{
      transform: translateY(-1px);
      border-color: rgba(148, 163, 255, 0.6);
      box-shadow: 0 12px 40px rgba(80,180,255,.25), inset 0 1px 0 rgba(255,255,255,.4);
    }
    .liquid-btn:active{ transform: translateY(0px) scale(.99); }

    /* Liquid layers */
    .liquid-btn .sheen{
      position:absolute; inset:-40%;
      background: radial-gradient(120px 80px at var(--x,50%) var(--y,50%), rgba(255,255,255,.25), transparent 55%);
      filter: blur(14px);
      opacity:.35; transition: opacity .25s ease;
      pointer-events:none;
    }
    .liquid-btn:hover .sheen{ opacity:.6; }
    .liquid-btn .bubbles{
      position:absolute; inset:-20%;
      background:
        radial-gradient(18px 24px at 20% 60%, rgba(110,231,255,.22), transparent 60%),
        radial-gradient(26px 26px at 70% 30%, rgba(167,139,250,.22), transparent 60%),
        radial-gradient(14px 16px at 40% 80%, rgba(94,234,212,.22), transparent 60%),
        radial-gradient(22px 18px at 85% 75%, rgba(110,231,255,.18), transparent 60%);
      filter: blur(12px);
      animation: drift 8s ease-in-out infinite;
      pointer-events:none;
      opacity:.7;
    }
    @keyframes drift{
      0%{ transform: translate(0,0) }
      50%{ transform: translate(6px,-6px) }
      100%{ transform: translate(0,0) }
    }

    /* Section tabs underline animation */
    .tab{
      position:relative;
    }
    .tab::after{
      content:'';
      position:absolute; left:0; bottom:-10px; height:2px; width:0%;
      background: linear-gradient(90deg, #22d3ee, #a78bfa);
      transition: width .25s ease;
      border-radius: 2px;
    }
    .tab.active::after{ width: 100%; }

    /* Data table styling */
    .table{
      border-collapse: separate;
      border-spacing: 0 10px;
      width:100%;
    }
    .table thead th{
      font-weight:600; letter-spacing:.02em; color:#cfe8ff;
      padding:10px 14px;
    }
    .table tbody tr{
      transition: transform .15s ease, background .2s ease;
    }
    .table tbody tr:hover{ transform: translateY(-1px); }
    .row-card{
      background: linear-gradient(180deg, rgba(255,255,255,0.07), rgba(255,255,255,0.03));
      border:1px solid var(--stroke);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .cell{ padding:14px 16px; }
    .pill{
      padding:6px 10px; border-radius:999px; font-weight:600; font-size:.8rem;
    }

    /* Simple in-view fade */
    .fade-up{
      opacity:0; transform: translateY(10px);
      animation: fadeUp .6s ease forwards var(--delay, 0s);
    }
    @keyframes fadeUp{
      to{ opacity:1; transform: translateY(0) }
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- Ambient glows -->
  <div class="orb one"></div>
  <div class="orb two"></div>
  <div class="orb three"></div>

  <!-- Topbar -->
  <header class="px-6 lg:px-10 py-5 flex items-center justify-between relative z-10">
    <div class="flex items-center gap-4">
      <div class="w-11 h-11 rounded-2xl glass grid place-content-center">
        <!-- Simple medical cross -->
        <svg width="24" height="24" viewBox="0 0 24 24" class="text-cyan-300"><path fill="currentColor" d="M10 3h4v7h7v4h-7v7h-4v-7H3v-4h7z"/></svg>
      </div>
      <div>
        <h1 class="text-xl sm:text-2xl font-extrabold tracking-tight" style="font-family:'Plus Jakarta Sans', Inter">HospitalOS</h1>
        <p class="text-cyan-200/80 text-xs">Industrial-grade management (Demo)</p>
      </div>
    </div>

    <div class="hidden md:flex items-center gap-3">
      <div class="glass rounded-xl px-4 py-2 flex items-center gap-2">
        <svg width="18" height="18" viewBox="0 0 24 24" class="text-cyan-200/70"><path fill="currentColor" d="M10 18a8 8 0 1 1 5.293-14.293A8 8 0 0 1 10 18Zm11 3.707L16.314 17.02A9.953 9.953 0 0 0 20 10a10 10 0 1 0-10 10a9.953 9.953 0 0 0 7.02-3.686L21.707 21.7z"/></svg>
        <input id="globalSearch" placeholder="Search patients, staff, branches..." class="bg-transparent outline-none placeholder:text-cyan-200/50 text-sm w-64" />
      </div>
      <button id="quickAddBtn" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
        <div class="sheen"></div><div class="bubbles"></div>
        + Quick Add
      </button>
    </div>
  </header>

  <!-- Content -->
  <main class="px-6 lg:px-10 pb-16 relative z-10">
    <!-- Tabs -->
    <nav class="flex flex-wrap gap-4 mb-6">
      <button data-tab="overview" class="tab active glass rounded-xl px-4 py-2 text-sm">Overview</button>
      <button data-tab="patients" class="tab glass rounded-xl px-4 py-2 text-sm">Patients</button>
      <button data-tab="appointments" class="tab glass rounded-xl px-4 py-2 text-sm">Appointments</button>
      <button data-tab="staff" class="tab glass rounded-xl px-4 py-2 text-sm">Staff</button>
      <button data-tab="branches" class="tab glass rounded-xl px-4 py-2 text-sm">Branches</button>
      <button data-tab="insurance" class="tab glass rounded-xl px-4 py-2 text-sm">Insurance</button>
    </nav>

    <!-- Overview -->
    <section id="panel-overview" class="space-y-6">
      <!-- KPI Cards -->
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="glass rounded-2xl p-5 fade-up" style="--delay:.05s">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm text-cyan-200/80">Active Patients</h3>
            <span class="pill bg-cyan-500/20 text-cyan-200">Live</span>
          </div>
          <div class="flex items-end gap-3">
            <p id="kpiPatients" class="text-3xl font-extrabold">0</p>
            <span class="text-emerald-300 text-xs bg-emerald-500/10 border border-emerald-300/30 rounded-full px-2 py-0.5">+3 today</span>
          </div>
          <div class="mt-4">
            <!-- simple sparkline -->
            <svg viewBox="0 0 100 28" class="w-full h-14">
              <defs>
                <linearGradient id="sp1" x1="0" x2="1" y1="0" y2="0">
                  <stop offset="0%" stop-color="#22d3ee" stop-opacity=".9"/>
                  <stop offset="100%" stop-color="#a78bfa" stop-opacity=".9"/>
                </linearGradient>
              </defs>
              <polyline fill="none" stroke="url(#sp1)" stroke-width="2"
                points="0,20 10,17 20,18 30,14 40,12 50,15 60,10 70,9 80,12 90,7 100,9" />
            </svg>
          </div>
        </div>
        <div class="glass rounded-2xl p-5 fade-up" style="--delay:.1s">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm text-cyan-200/80">Appointments Today</h3>
            <span class="pill bg-fuchsia-500/20 text-fuchsia-200">Now</span>
          </div>
          <p id="kpiAppointments" class="text-3xl font-extrabold">0</p>
          <div class="mt-4 flex items-center gap-2 text-xs text-cyan-200/80">
            <span class="w-2 h-2 rounded-full bg-emerald-400"></span> Scheduled
            <span class="w-2 h-2 rounded-full bg-amber-400 ml-3"></span> Completed
          </div>
        </div>
        <div class="glass rounded-2xl p-5 fade-up" style="--delay:.15s">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm text-cyan-200/80">Active Doctors</h3>
            <span class="pill bg-emerald-500/15 text-emerald-200">OK</span>
          </div>
          <p id="kpiDoctors" class="text-3xl font-extrabold">0</p>
          <div class="mt-4 text-xs text-cyan-200/70">Across all branches</div>
        </div>
        <div class="glass rounded-2xl p-5 fade-up" style="--delay:.2s">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm text-cyan-200/80">Insurance Coverage</h3>
            <span class="pill bg-cyan-500/15 text-cyan-200">Avg</span>
          </div>
          <div class="flex items-center gap-4">
            <svg width="64" height="64" viewBox="0 0 36 36">
              <defs>
                <linearGradient id="ring" x1="0" x2="1">
                  <stop offset="0%" stop-color="#22d3ee"/>
                  <stop offset="100%" stop-color="#a78bfa"/>
                </linearGradient>
              </defs>
              <circle cx="18" cy="18" r="14" fill="none" stroke="rgba(255,255,255,.1)" stroke-width="6"/>
              <circle cx="18" cy="18" r="14" fill="none" stroke="url(#ring)" stroke-linecap="round" stroke-width="6"
                stroke-dasharray="65 100" transform="rotate(-90 18 18)"/>
            </svg>
            <div>
              <p id="kpiCoverage" class="text-3xl font-extrabold">0%</p>
              <p class="text-xs text-cyan-200/70">Average coverage</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick actions -->
      <div class="glass rounded-2xl p-5">
        <div class="flex flex-wrap items-center justify-between gap-4">
          <div>
            <h3 class="font-semibold">Quick Actions</h3>
            <p class="text-cyan-200/70 text-sm mt-1">Speed up your day with one-tap actions</p>
          </div>
          <div class="flex flex-wrap gap-3">
            <button id="qaNewPatient" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
              <div class="sheen"></div><div class="bubbles"></div>
              New Patient
            </button>
            <button id="qaNewAppointment" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
              <div class="sheen"></div><div class="bubbles"></div>
              Schedule Appointment
            </button>
            <button id="qaNewStaff" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
              <div class="sheen"></div><div class="bubbles"></div>
              Add Staff
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Patients -->
    <section id="panel-patients" class="hidden space-y-5">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <div>
          <h3 class="text-xl font-bold">Patients</h3>
          <p class="text-cyan-200/70 text-sm">Manage profiles and contacts</p>
        </div>
        <div class="flex items-center gap-2">
          <input id="patientSearch" placeholder="Search name or phone" class="glass rounded-xl px-4 py-2 text-sm outline-none" />
          <button id="addPatientBtn" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
            <div class="sheen"></div><div class="bubbles"></div>
            + Add Patient
          </button>
        </div>
      </div>
      <div class="glass rounded-2xl p-4 overflow-x-auto">
        <table class="table">
          <thead>
            <tr>
              <th class="text-left">Name</th>
              <th class="text-left">DOB</th>
              <th class="text-left">Gender</th>
              <th class="text-left">Phone</th>
              <th class="text-left">Email</th>
              <th class="text-left">Actions</th>
            </tr>
          </thead>
          <tbody id="patientsTbody"></tbody>
        </table>
      </div>
    </section>

    <!-- Appointments -->
    <section id="panel-appointments" class="hidden space-y-5">
      <div class="flex flex-wrap items-center justify-between gap-4">
        <div>
          <h3 class="text-xl font-bold">Appointments</h3>
          <p class="text-cyan-200/70 text-sm">Schedule, update, and track</p>
        </div>
        <div class="flex items-center gap-2">
          <select id="apptStatusFilter" class="glass rounded-xl px-3 py-2 text-sm outline-none">
            <option value="">All Status</option>
            <option>Scheduled</option>
            <option>Completed</option>
            <option>Cancelled</option>
          </select>
          <button id="addApptBtn" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
            <div class="sheen"></div><div class="bubbles"></div>
            + Schedule
          </button>
        </div>
      </div>
      <div class="glass rounded-2xl p-4 overflow-x-auto">
        <table class="table">
          <thead>
            <tr>
              <th class="text-left">Patient</th>
              <th class="text-left">Doctor</th>
              <th class="text-left">Branch</th>
              <th class="text-left">Date</th>
              <th class="text-left">Time</th>
              <th class="text-left">Status</th>
              <th class="text-left">Actions</th>
            </tr>
          </thead>
          <tbody id="apptsTbody"></tbody>
        </table>
      </div>
    </section>

    <!-- Staff -->
    <section id="panel-staff" class="hidden space-y-5">
      <div class="flex items-center justify-between flex-wrap gap-4">
        <div>
          <h3 class="text-xl font-bold">Staff</h3>
          <p class="text-cyan-200/70 text-sm">Doctors, nurses, and more</p>
        </div>
        <div class="flex items-center gap-2">
          <select id="staffRoleFilter" class="glass rounded-xl px-3 py-2 text-sm outline-none">
            <option value="">All Roles</option>
            <option>Doctor</option>
            <option>Nurse</option>
            <option>Receptionist</option>
            <option>Admin</option>
            <option>Other</option>
          </select>
          <button id="addStaffBtn" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
            <div class="sheen"></div><div class="bubbles"></div>
            + Add Staff
          </button>
        </div>
      </div>
      <div class="glass rounded-2xl p-4 overflow-x-auto">
        <table class="table">
          <thead>
            <tr>
              <th class="text-left">Name</th>
              <th class="text-left">Role</th>
              <th class="text-left">Speciality</th>
              <th class="text-left">Email</th>
              <th class="text-left">Branch</th>
              <th class="text-left">Active</th>
              <th class="text-left">Actions</th>
            </tr>
          </thead>
          <tbody id="staffTbody"></tbody>
        </table>
      </div>
    </section>

    <!-- Branches -->
    <section id="panel-branches" class="hidden space-y-5">
      <div class="flex items-center justify-between flex-wrap gap-4">
        <div>
          <h3 class="text-xl font-bold">Branches</h3>
          <p class="text-cyan-200/70 text-sm">Locations and contact</p>
        </div>
        <button id="addBranchBtn" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
          <div class="sheen"></div><div class="bubbles"></div>
          + Add Branch
        </button>
      </div>
      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4" id="branchesGrid"></div>
    </section>

    <!-- Insurance -->
    <section id="panel-insurance" class="hidden space-y-5">
      <div class="flex items-center justify-between flex-wrap gap-4">
        <div>
          <h3 class="text-xl font-bold">Insurance</h3>
          <p class="text-cyan-200/70 text-sm">Policies and coverage</p>
        </div>
        <button id="addPolicyBtn" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
          <div class="sheen"></div><div class="bubbles"></div>
          + Add Policy
        </button>
      </div>
      <div class="glass rounded-2xl p-4 overflow-x-auto">
        <table class="table">
          <thead>
            <tr>
              <th class="text-left">Patient</th>
              <th class="text-left">Provider</th>
              <th class="text-left">Policy #</th>
              <th class="text-left">Coverage</th>
              <th class="text-left">Deductible</th>
              <th class="text-left">Expiry</th>
              <th class="text-left">Active</th>
              <th class="text-left">Actions</th>
            </tr>
          </thead>
          <tbody id="policyTbody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- Modals -->
  <div id="modalBack" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4 z-50">
    <div class="glass rounded-2xl w-full max-w-xl p-5 relative">
      <button id="modalClose" class="absolute right-3 top-3 text-cyan-200/70 hover:text-white">
        <svg width="22" height="22" viewBox="0 0 24 24"><path fill="currentColor" d="M18.3 5.71L12 12l6.3 6.29l-1.41 1.42L10.59 13.4L4.3 19.71L2.89 18.3L9.18 12L2.89 5.71L4.3 4.29L10.59 10.6l6.3-6.31z"/></svg>
      </button>
      <h3 id="modalTitle" class="text-lg font-bold mb-4">Title</h3>
      <form id="modalForm" class="space-y-3">
        <!-- Dynamic fields go here -->
      </form>
      <div class="mt-5 flex items-center justify-end gap-2">
        <button id="modalCancel" class="glass rounded-xl px-4 py-2 text-sm">Cancel</button>
        <button id="modalSave" class="liquid-btn rounded-xl px-4 py-2 text-sm font-semibold relative">
          <div class="sheen"></div><div class="bubbles"></div>
          Save
        </button>
      </div>
      <p class="text-[11px] text-cyan-200/60 mt-4">Demo only â€” no data leaves your browser.</p>
    </div>
  </div>

  <!-- Demo banner -->
  <div class="fixed left-1/2 -translate-x-1/2 bottom-4 px-4 py-2 glass rounded-xl text-xs text-cyan-100 z-40">
    Demo: No real backend. Buttons and forms work locally.
  </div>

  <script>
    // Simple state (in-memory demo)
    const state = {
      branches: [
        { branch_id:1, branch_name:'Central', location:'Downtown', phone:'5551112222', created_at:new Date() },
        { branch_id:2, branch_name:'Northside', location:'Uptown', phone:'5553334444', created_at:new Date() },
      ],
      patients: [
        { patient_id:1, first_name:'Ava', last_name:'Rao', date_of_birth:'1990-03-12', gender:'Female', phone:'5550001111', email:'ava.rao@example.com', address:'12 Blue St', emergency_contact:'5554447777', created_at:new Date(), updated_at:new Date() },
        { patient_id:2, first_name:'Liam', last_name:'Chen', date_of_birth:'1985-11-02', gender:'Male', phone:'5552223333', email:'liam.chen@example.com', address:'34 Lake Ave', emergency_contact:'5558889999', created_at:new Date(), updated_at:new Date() },
      ],
      staff: [
        { staff_id:1, first_name:'Dr. Maya', last_name:'Singh', role:'Doctor', speciality:'Cardiology', email:'maya.singh@hospitalos.com', branch_id:1, created_at:new Date(), is_active:1 },
        { staff_id:2, first_name:'Dr. Noah', last_name:'Kim', role:'Doctor', speciality:'Pediatrics', email:'noah.kim@hospitalos.com', branch_id:2, created_at:new Date(), is_active:1 },
        { staff_id:3, first_name:'Zara', last_name:'Lopez', role:'Nurse', speciality:'ICU', email:'zara.lopez@hospitalos.com', branch_id:1, created_at:new Date(), is_active:1 },
      ],
      appointments: [
        { appointment_id:1, patient_id:1, doctor_id:1, branch_id:1, appointment_date:today(), appointment_time:'10:30', status:'Scheduled', created_at:new Date(), updated_at:new Date() },
        { appointment_id:2, patient_id:2, doctor_id:2, branch_id:2, appointment_date:addDays(1), appointment_time:'14:00', status:'Scheduled', created_at:new Date(), updated_at:new Date() },
      ],
      policies: [
        { policy_id:1, patient_id:1, provider_name:'Blue Health', policy_number:'B12345', coverage_percentage:80.00, deductable:500.00, expiry_date:addDays(365), is_active:1, created_at:new Date() },
      ],
      counters: { branch_id:3, patient_id:3, staff_id:4, appointment_id:3, policy_id:2 }
    };

    function today(){ return new Date().toISOString().slice(0,10); }
    function addDays(n){
      const d = new Date(); d.setDate(d.getDate()+n);
      return d.toISOString().slice(0,10);
    }

    // Tabs
    const tabs = document.querySelectorAll('button[data-tab]');
    const panels = {
      overview: document.getElementById('panel-overview'),
      patients: document.getElementById('panel-patients'),
      appointments: document.getElementById('panel-appointments'),
      staff: document.getElementById('panel-staff'),
      branches: document.getElementById('panel-branches'),
      insurance: document.getElementById('panel-insurance'),
    };
    tabs.forEach(t=>{
      t.addEventListener('click', ()=>{
        tabs.forEach(b=>b.classList.remove('active'));
        t.classList.add('active');
        Object.values(panels).forEach(p=>p.classList.add('hidden'));
        panels[t.dataset.tab].classList.remove('hidden');
      });
    });

    // Global search filters visible lists
    document.getElementById('globalSearch').addEventListener('input', (e)=>{
      const q = e.target.value.toLowerCase();
      filterPatients(q);
      filterStaff(q);
      filterBranches(q);
      filterPolicies(q);
      filterAppts(); // reapply status filter only
    });

    // Liquid sheen follows mouse
    document.addEventListener('pointermove', (e)=>{
      document.querySelectorAll('.liquid-btn').forEach(btn=>{
        const r = btn.getBoundingClientRect();
        const x = ((e.clientX - r.left)/r.width)*100;
        const y = ((e.clientY - r.top)/r.height)*100;
        btn.style.setProperty('--x', x+'%');
        btn.style.setProperty('--y', y+'%');
      });
    });

    // Render functions
    const patientsTbody = document.getElementById('patientsTbody');
    const apptsTbody = document.getElementById('apptsTbody');
    const staffTbody = document.getElementById('staffTbody');
    const branchesGrid = document.getElementById('branchesGrid');
    const policyTbody = document.getElementById('policyTbody');

    function renderKPIs(){
      document.getElementById('kpiPatients').textContent = state.patients.length;
      document.getElementById('kpiAppointments').textContent = state.appointments.filter(a=>a.appointment_date===today()).length;
      document.getElementById('kpiDoctors').textContent = state.staff.filter(s=>s.role==='Doctor' && s.is_active).length;
      const avg = state.policies.length ? Math.round(state.policies.reduce((a,p)=>a+p.coverage_percentage,0)/state.policies.length) : 0;
      document.getElementById('kpiCoverage').textContent = avg+'%';
    }

    function renderPatients(list=state.patients){
      patientsTbody.innerHTML = '';
      const q = document.getElementById('patientSearch').value?.toLowerCase() || '';
      const filtered = list.filter(p =>
        (p.first_name+' '+p.last_name).toLowerCase().includes(q) ||
        (p.phone||'').includes(q)
      );
      filtered.forEach(p=>{
        const tr = document.createElement('tr');
        tr.className='row-card';
        tr.innerHTML = `
          <td class="cell font-semibold">${p.first_name} ${p.last_name}</td>
          <td class="cell">${p.date_of_birth || '-'}</td>
          <td class="cell">${p.gender || '-'}</td>
          <td class="cell">${p.phone || '-'}</td>
          <td class="cell">${p.email || '-'}</td>
          <td class="cell">
            <div class="flex gap-2">
              <button class="glass rounded-lg px-3 py-1 text-xs" data-action="edit" data-id="${p.patient_id}">Edit</button>
              <button class="glass rounded-lg px-3 py-1 text-xs" data-action="appt" data-id="${p.patient_id}">Schedule</button>
              <button class="glass rounded-lg px-3 py-1 text-xs text-rose-300" data-action="del" data-id="${p.patient_id}">Delete</button>
            </div>
          </td>`;
        patientsTbody.appendChild(tr);
      });
    }

    function renderStaff(){
      staffTbody.innerHTML = '';
      const role = document.getElementById('staffRoleFilter').value;
      const q = document.getElementById('globalSearch').value.toLowerCase();
      state.staff
        .filter(s => !role || s.role===role)
        .filter(s => (s.first_name+' '+s.last_name).toLowerCase().includes(q) || (s.email||'').toLowerCase().includes(q))
        .forEach(s=>{
          const b = state.branches.find(b=>b.branch_id===s.branch_id);
          const tr = document.createElement('tr');
          tr.className='row-card';
          tr.innerHTML = `
            <td class="cell font-semibold">${s.first_name} ${s.last_name}</td>
            <td class="cell">${s.role}</td>
            <td class="cell">${s.speciality || '-'}</td>
            <td class="cell">${s.email || '-'}</td>
            <td class="cell">${b? b.branch_name : '-'}</td>
            <td class="cell">
              <span class="pill ${s.is_active?'bg-emerald-500/15 text-emerald-200':'bg-rose-500/15 text-rose-200'}">${s.is_active? 'Active':'Off'}</span>
            </td>
            <td class="cell">
              <div class="flex gap-2">
                <button class="glass rounded-lg px-3 py-1 text-xs" data-action="edit" data-id="${s.staff_id}">Edit</button>
                <button class="glass rounded-lg px-3 py-1 text-xs text-rose-300" data-action="del" data-id="${s.staff_id}">Delete</button>
              </div>
            </td>`;
          staffTbody.appendChild(tr);
        });
    }

    function renderBranches(){
      branchesGrid.innerHTML = '';
      const q = document.getElementById('globalSearch').value.toLowerCase();
      state.branches
        .filter(b => (b.branch_name+' '+(b.location||'')+' '+(b.phone||'')).toLowerCase().includes(q))
        .forEach(b=>{
          const card = document.createElement('div');
          card.className = 'glass rounded-2xl p-4';
          card.innerHTML = `
            <div class="flex items-center justify-between mb-2">
              <h4 class="font-bold">${b.branch_name}</h4>
              <span class="pill bg-cyan-500/15 text-cyan-200">#${b.branch_id}</span>
            </div>
            <p class="text-sm text-cyan-200/80">Location: ${b.location || '-'}</p>
            <p class="text-sm text-cyan-200/80">Phone: ${b.phone || '-'}</p>
            <div class="mt-3 flex gap-2">
              <button class="glass rounded-lg px-3 py-1 text-xs" data-action="edit" data-id="${b.branch_id}">Edit</button>
              <button class="glass rounded-lg px-3 py-1 text-xs text-rose-300" data-action="del" data-id="${b.branch_id}">Delete</button>
            </div>`;
          branchesGrid.appendChild(card);
        });
    }

    function renderPolicies(){
      policyTbody.innerHTML = '';
      const q = document.getElementById('globalSearch').value.toLowerCase();
      state.policies
        .filter(p=>{
          const patient = state.patients.find(pa=>pa.patient_id===p.patient_id);
          const name = patient? (patient.first_name+' '+patient.last_name).toLowerCase() : '';
          return name.includes(q) || (p.provider_name||'').toLowerCase().includes(q) || (p.policy_number||'').toLowerCase().includes(q);
        })
        .forEach(p=>{
          const patient = state.patients.find(pa=>pa.patient_id===p.patient_id);
          const tr = document.createElement('tr');
          tr.className='row-card';
          tr.innerHTML = `
            <td class="cell font-semibold">${patient? patient.first_name+' '+patient.last_name : '-'}</td>
            <td class="cell">${p.provider_name || '-'}</td>
            <td class="cell">${p.policy_number || '-'}</td>
            <td class="cell">${p.coverage_percentage?.toFixed(0)}%</td>
            <td class="cell">$${Number(p.deductable||0).toFixed(2)}</td>
            <td class="cell">${p.expiry_date}</td>
            <td class="cell">
              <span class="pill ${p.is_active?'bg-emerald-500/15 text-emerald-200':'bg-rose-500/15 text-rose-200'}">${p.is_active? 'Active':'Inactive'}</span>
            </td>
            <td class="cell">
              <div class="flex gap-2">
                <button class="glass rounded-lg px-3 py-1 text-xs" data-action="edit" data-id="${p.policy_id}">Edit</button>
                <button class="glass rounded-lg px-3 py-1 text-xs text-rose-300" data-action="del" data-id="${p.policy_id}">Delete</button>
              </div>
            </td>`;
          policyTbody.appendChild(tr);
        });
    }

    function renderAppts(){
      apptsTbody.innerHTML = '';
      const status = document.getElementById('apptStatusFilter').value;
      state.appointments
        .filter(a => !status || a.status===status)
        .forEach(a=>{
          const p = state.patients.find(p=>p.patient_id===a.patient_id);
          const d = state.staff.find(s=>s.staff_id===a.doctor_id);
          const b = state.branches.find(b=>b.branch_id===a.branch_id);
          const tr = document.createElement('tr');
          tr.className='row-card';
          tr.innerHTML = `
            <td class="cell font-semibold">${p? p.first_name+' '+p.last_name : '-'}</td>
            <td class="cell">${d? d.first_name+' '+d.last_name : '-'}</td>
            <td class="cell">${b? b.branch_name : '-'}</td>
            <td class="cell">${a.appointment_date}</td>
            <td class="cell">${a.appointment_time}</td>
            <td class="cell">
              <span class="pill ${
                a.status==='Scheduled' ? 'bg-cyan-500/15 text-cyan-200' :
                a.status==='Completed' ? 'bg-emerald-500/15 text-emerald-200' :
                'bg-amber-500/15 text-amber-200'
              }">${a.status}</span>
            </td>
            <td class="cell">
              <div class="flex gap-2">
                <button class="glass rounded-lg px-3 py-1 text-xs" data-action="edit" data-id="${a.appointment_id}">Edit</button>
                <button class="glass rounded-lg px-3 py-1 text-xs" data-action="complete" data-id="${a.appointment_id}">Complete</button>
                <button class="glass rounded-lg px-3 py-1 text-xs text-rose-300" data-action="del" data-id="${a.appointment_id}">Delete</button>
              </div>
            </td>`;
          apptsTbody.appendChild(tr);
        });
    }

    function filterPatients(q){ renderPatients(state.patients.filter(p=>
      (p.first_name+' '+p.last_name).toLowerCase().includes(q) || (p.phone||'').includes(q))); }
    function filterStaff(q){ renderStaff(); }
    function filterBranches(q){ renderBranches(); }
    function filterPolicies(q){ renderPolicies(); }
    function filterAppts(){ renderAppts(); }

    // Modal system
    const modalBack = document.getElementById('modalBack');
    const modalTitle = document.getElementById('modalTitle');
    const modalForm = document.getElementById('modalForm');
    const modalClose = document.getElementById('modalClose');
    const modalCancel = document.getElementById('modalCancel');
    const modalSave = document.getElementById('modalSave');

    let currentModal = null; // {type, id?}

    function openModal(type, id=null){
      currentModal = {type, id};
      modalForm.innerHTML = '';
      modalTitle.textContent = ({
        patient: id? 'Edit Patient':'Add Patient',
        appt: id? 'Edit Appointment':'Schedule Appointment',
        staff: id? 'Edit Staff':'Add Staff',
        branch: id? 'Edit Branch':'Add Branch',
        policy: id? 'Edit Policy':'Add Policy'
      })[type] || 'Form';

      if(type==='patient'){
        const p = id? state.patients.find(x=>x.patient_id===id) : {};
        modalForm.innerHTML = `
          <div class="grid sm:grid-cols-2 gap-3">
            <input class="glass rounded-xl px-3 py-2" placeholder="First name" name="first_name" value="${p.first_name||''}" required />
            <input class="glass rounded-xl px-3 py-2" placeholder="Last name" name="last_name" value="${p.last_name||''}" required />
            <input class="glass rounded-xl px-3 py-2" type="date" name="date_of_birth" value="${p.date_of_birth||''}" />
            <select class="glass rounded-xl px-3 py-2" name="gender">
              <option ${!p.gender?'selected':''} disabled value="">Gender</option>
              <option ${p.gender==='Male'?'selected':''}>Male</option>
              <option ${p.gender==='Female'?'selected':''}>Female</option>
              <option ${p.gender==='Other'?'selected':''}>Other</option>
            </select>
            <input class="glass rounded-xl px-3 py-2" placeholder="Phone" name="phone" value="${p.phone||''}" />
            <input class="glass rounded-xl px-3 py-2" placeholder="Email" name="email" value="${p.email||''}" />
          </div>
          <textarea class="glass rounded-xl px-3 py-2 w-full" placeholder="Address" name="address">${p.address||''}</textarea>
          <input class="glass rounded-xl px-3 py-2 w-full" placeholder="Emergency contact" name="emergency_contact" value="${p.emergency_contact||''}" />
        `;
      }

      if(type==='appt'){
        const a = id? state.appointments.find(x=>x.appointment_id===id) : {};
        const patientOptions = state.patients.map(p=>`<option value="${p.patient_id}" ${a.patient_id===p.patient_id?'selected':''}>${p.first_name} ${p.last_name}</option>`).join('');
        const doctorOptions = state.staff.filter(s=>s.role==='Doctor').map(s=>`<option value="${s.staff_id}" ${a.doctor_id===s.staff_id?'selected':''}>${s.first_name} ${s.last_name} â€” ${s.speciality||'General'}</option>`).join('');
        const branchOptions = state.branches.map(b=>`<option value="${b.branch_id}" ${a.branch_id===b.branch_id?'selected':''}>${b.branch_name}</option>`).join('');
        modalForm.innerHTML = `
          <div class="grid sm:grid-cols-2 gap-3">
            <select class="glass rounded-xl px-3 py-2" name="patient_id" required>
              ${patientOptions}
            </select>
            <select class="glass rounded-xl px-3 py-2" name="doctor_id" required>
              ${doctorOptions}
            </select>
            <select class="glass rounded-xl px-3 py-2" name="branch_id" required>
              ${branchOptions}
            </select>
            <input class="glass rounded-xl px-3 py-2" type="date" name="appointment_date" value="${a.appointment_date||today()}" required />
            <input class="glass rounded-xl px-3 py-2" type="time" name="appointment_time" value="${a.appointment_time||'09:00'}" required />
            <select class="glass rounded-xl px-3 py-2" name="status">
              <option ${a.status==='Scheduled'?'selected':''}>Scheduled</option>
              <option ${a.status==='Completed'?'selected':''}>Completed</option>
              <option ${a.status==='Cancelled'?'selected':''}>Cancelled</option>
            </select>
          </div>
        `;
      }

      if(type==='staff'){
        const s = id? state.staff.find(x=>x.staff_id===id) : {};
        const branchOptions = state.branches.map(b=>`<option value="${b.branch_id}" ${s.branch_id===b.branch_id?'selected':''}>${b.branch_name}</option>`).join('');
        modalForm.innerHTML = `
          <div class="grid sm:grid-cols-2 gap-3">
            <input class="glass rounded-xl px-3 py-2" placeholder="First name" name="first_name" value="${s.first_name||''}" required />
            <input class="glass rounded-xl px-3 py-2" placeholder="Last name" name="last_name" value="${s.last_name||''}" required />
            <select class="glass rounded-xl px-3 py-2" name="role" required>
              ${['Admin','Doctor','Nurse','Receptionist','Other'].map(r=>`<option ${s.role===r?'selected':''}>${r}</option>`).join('')}
            </select>
            <input class="glass rounded-xl px-3 py-2" placeholder="Speciality" name="speciality" value="${s.speciality||''}" />
            <input class="glass rounded-xl px-3 py-2" placeholder="Email" name="email" value="${s.email||''}" />
            <select class="glass rounded-xl px-3 py-2" name="branch_id" required>${branchOptions}</select>
            <label class="flex items-center gap-2 text-sm">
              <input type="checkbox" name="is_active" ${s?.is_active? 'checked':''} />
              Active
            </label>
          </div>
          <p class="text-[11px] text-cyan-200/70">Passwords are not collected in this demo.</p>
        `;
      }

      if(type==='branch'){
        const b = id? state.branches.find(x=>x.branch_id===id) : {};
        modalForm.innerHTML = `
          <div class="grid sm:grid-cols-2 gap-3">
            <input class="glass rounded-xl px-3 py-2" placeholder="Branch name" name="branch_name" value="${b.branch_name||''}" required />
            <input class="glass rounded-xl px-3 py-2" placeholder="Location" name="location" value="${b.location||''}" />
            <input class="glass rounded-xl px-3 py-2" placeholder="Phone" name="phone" value="${b.phone||''}" />
          </div>
        `;
      }

      if(type==='policy'){
        const p = id? state.policies.find(x=>x.policy_id===id) : {};
        const patientOptions = state.patients.map(pt=>`<option value="${pt.patient_id}" ${p.patient_id===pt.patient_id?'selected':''}>${pt.first_name} ${pt.last_name}</option>`).join('');
        modalForm.innerHTML = `
          <div class="grid sm:grid-cols-2 gap-3">
            <select class="glass rounded-xl px-3 py-2" name="patient_id" required>${patientOptions}</select>
            <input class="glass rounded-xl px-3 py-2" placeholder="Provider name" name="provider_name" value="${p.provider_name||''}" />
            <input class="glass rounded-xl px-3 py-2" placeholder="Policy number" name="policy_number" value="${p.policy_number||''}" />
            <input class="glass rounded-xl px-3 py-2" type="number" step="1" min="0" max="100" placeholder="Coverage %" name="coverage_percentage" value="${p.coverage_percentage??80}" />
            <input class="glass rounded-xl px-3 py-2" type="number" step="0.01" min="0" placeholder="Deductible" name="deductable" value="${p.deductable??0}" />
            <input class="glass rounded-xl px-3 py-2" type="date" name="expiry_date" value="${p.expiry_date||today()}" />
            <label class="flex items-center gap-2 text-sm">
              <input type="checkbox" name="is_active" ${p?.is_active? 'checked':''} />
              Active
            </label>
          </div>
        `;
      }

      modalBack.classList.remove('hidden');
      modalBack.classList.add('flex');
    }

    function closeModal(){
      modalBack.classList.add('hidden');
      modalBack.classList.remove('flex');
      currentModal = null;
    }
    modalClose.addEventListener('click', closeModal);
    modalCancel.addEventListener('click', closeModal);

    modalSave.addEventListener('click', (e)=>{
      e.preventDefault();
      if(!currentModal) return;
      const fd = new FormData(modalForm);
      const type = currentModal.type;
      const id = currentModal.id;

      if(type==='patient'){
        const payload = Object.fromEntries(fd.entries());
        const base = {
          first_name: payload.first_name?.trim(),
          last_name: payload.last_name?.trim(),
          date_of_birth: payload.date_of_birth || null,
          gender: payload.gender || null,
          phone: payload.phone || null,
          email: payload.email || null,
          address: payload.address || null,
          emergency_contact: payload.emergency_contact || null,
          updated_at: new Date()
        };
        if(id){
          const idx = state.patients.findIndex(p=>p.patient_id===id);
          if(idx>-1) state.patients[idx] = {...state.patients[idx], ...base};
        }else{
          state.patients.push({ patient_id: state.counters.patient_id++, created_at:new Date(), ...base });
        }
        renderPatients(); renderKPIs();
      }

      if(type==='appt'){
        const payload = Object.fromEntries(fd.entries());
        const base = {
          patient_id: Number(payload.patient_id),
          doctor_id: Number(payload.doctor_id),
          branch_id: Number(payload.branch_id),
          appointment_date: payload.appointment_date,
          appointment_time: payload.appointment_time,
          status: payload.status,
          updated_at: new Date()
        };
        if(id){
          const idx = state.appointments.findIndex(a=>a.appointment_id===id);
          if(idx>-1) state.appointments[idx] = {...state.appointments[idx], ...base};
        }else{
          state.appointments.push({ appointment_id: state.counters.appointment_id++, created_at:new Date(), ...base });
        }
        renderAppts(); renderKPIs();
      }

      if(type==='staff'){
        const payload = Object.fromEntries(fd.entries());
        const base = {
          first_name: payload.first_name?.trim(),
          last_name: payload.last_name?.trim(),
          role: payload.role,
          speciality: payload.speciality || null,
          email: payload.email || null,
          branch_id: Number(payload.branch_id),
          is_active: payload.is_active==='on'?1:0,
        };
        if(id){
          const idx = state.staff.findIndex(s=>s.staff_id===id);
          if(idx>-1) state.staff[idx] = {...state.staff[idx], ...base};
        }else{
          state.staff.push({ staff_id: state.counters.staff_id++, created_at:new Date(), ...base });
        }
        renderStaff(); renderKPIs();
      }

      if(type==='branch'){
        const payload = Object.fromEntries(fd.entries());
        const base = {
          branch_name: payload.branch_name?.trim(),
          location: payload.location || null,
          phone: payload.phone || null,
        };
        if(id){
          const idx = state.branches.findIndex(b=>b.branch_id===id);
          if(idx>-1) state.branches[idx] = {...state.branches[idx], ...base};
        }else{
          state.branches.push({ branch_id: state.counters.branch_id++, created_at:new Date(), ...base });
        }
        renderBranches();
      }

      if(type==='policy'){
        const payload = Object.fromEntries(fd.entries());
        const base = {
          patient_id: Number(payload.patient_id),
          provider_name: payload.provider_name || null,
          policy_number: payload.policy_number || null,
          coverage_percentage: Number(payload.coverage_percentage||0),
          deductable: Number(payload.deductable||0),
          expiry_date: payload.expiry_date || today(),
          is_active: payload.is_active==='on'?1:0,
        };
        if(id){
          const idx = state.policies.findIndex(p=>p.policy_id===id);
          if(idx>-1) state.policies[idx] = {...state.policies[idx], ...base};
        }else{
          state.policies.push({ policy_id: state.counters.policy_id++, created_at:new Date(), ...base });
        }
        renderPolicies(); renderKPIs();
      }

      closeModal();
    });

    // Table actions
    patientsTbody.addEventListener('click', (e)=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const id = Number(btn.dataset.id);
      const action = btn.dataset.action;
      if(action==='edit') openModal('patient', id);
      if(action==='appt') openModal('appt', null), setTimeout(()=>{
        // preselect patient
        modalForm.querySelector('[name="patient_id"]').value = id;
      },0);
      if(action==='del'){
        const idx = state.patients.findIndex(p=>p.patient_id===id);
        if(idx>-1) state.patients.splice(idx,1);
        // also cleanup related
        state.appointments = state.appointments.filter(a=>a.patient_id!==id);
        state.policies = state.policies.filter(p=>p.patient_id!==id);
        renderPatients(); renderAppts(); renderPolicies(); renderKPIs();
      }
    });

    apptsTbody.addEventListener('click', (e)=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const id = Number(btn.dataset.id);
      const action = btn.dataset.action;
      if(action==='edit') openModal('appt', id);
      if(action==='complete'){
        const appt = state.appointments.find(a=>a.appointment_id===id);
        if(appt){ appt.status='Completed'; appt.updated_at=new Date(); renderAppts(); renderKPIs(); }
      }
      if(action==='del'){
        const idx = state.appointments.findIndex(a=>a.appointment_id===id);
        if(idx>-1) state.appointments.splice(idx,1);
        renderAppts(); renderKPIs();
      }
    });

    staffTbody.addEventListener('click', (e)=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const id = Number(btn.dataset.id);
      const action = btn.dataset.action;
      if(action==='edit') openModal('staff', id);
      if(action==='del'){
        // prevent deleting doctors with appointments in demo
        const hasAppts = state.appointments.some(a=>a.doctor_id===id);
        if(hasAppts){ alert('This staff member has appointments. Remove them first.'); return; }
        const idx = state.staff.findIndex(s=>s.staff_id===id);
        if(idx>-1) state.staff.splice(idx,1);
        renderStaff(); renderAppts(); renderKPIs();
      }
    });

    branchesGrid.addEventListener('click', (e)=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const id = Number(btn.dataset.id);
      const action = btn.dataset.action;
      if(action==='edit') openModal('branch', id);
      if(action==='del'){
        const used = state.staff.some(s=>s.branch_id===id) || state.appointments.some(a=>a.branch_id===id);
        if(used){ alert('This branch is in use by staff/appointments. Reassign first.'); return; }
        const idx = state.branches.findIndex(b=>b.branch_id===id);
        if(idx>-1) state.branches.splice(idx,1);
        renderBranches();
      }
    });

    policyTbody.addEventListener('click', (e)=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const id = Number(btn.dataset.id);
      const action = btn.dataset.action;
      if(action==='edit') openModal('policy', id);
      if(action==='del'){
        const idx = state.policies.findIndex(p=>p.policy_id===id);
        if(idx>-1) state.policies.splice(idx,1);
        renderPolicies(); renderKPIs();
      }
    });

    // Filters
    document.getElementById('patientSearch').addEventListener('input', ()=>renderPatients());
    document.getElementById('apptStatusFilter').addEventListener('change', renderAppts);
    document.getElementById('staffRoleFilter').addEventListener('change', renderStaff);

    // Quick actions and main header buttons
    document.getElementById('quickAddBtn').addEventListener('click', ()=>openModal('patient'));
    document.getElementById('qaNewPatient').addEventListener('click', ()=>{ openModal('patient'); tabs.forEach(b=>b.classList.remove('active')); panels.overview.classList.add('hidden'); panels.patients.classList.remove('hidden'); document.querySelector('[data-tab="patients"]').classList.add('active'); });
    document.getElementById('qaNewAppointment').addEventListener('click', ()=>{ openModal('appt'); tabs.forEach(b=>b.classList.remove('active')); panels.overview.classList.add('hidden'); panels.appointments.classList.remove('hidden'); document.querySelector('[data-tab="appointments"]').classList.add('active'); });
    document.getElementById('qaNewStaff').addEventListener('click', ()=>{ openModal('staff'); tabs.forEach(b=>b.classList.remove('active')); panels.overview.classList.add('hidden'); panels.staff.classList.remove('hidden'); document.querySelector('[data-tab="staff"]').classList.add('active'); });

    document.getElementById('addPatientBtn')?.addEventListener('click', ()=>openModal('patient'));
    document.getElementById('addApptBtn')?.addEventListener('click', ()=>openModal('appt'));
    document.getElementById('addStaffBtn')?.addEventListener('click', ()=>openModal('staff'));
    document.getElementById('addBranchBtn')?.addEventListener('click', ()=>openModal('branch'));
    document.getElementById('addPolicyBtn')?.addEventListener('click', ()=>openModal('policy'));

    // Initial render
    renderKPIs();
    renderPatients();
    renderAppts();
    renderStaff();
    renderBranches();
    renderPolicies();
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'981035b786089ff3',t:'MTc1ODE5MTg2NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
